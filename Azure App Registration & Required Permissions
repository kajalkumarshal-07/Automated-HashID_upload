Azure App Registration & Required Permissions

To enable automated Autopilot device upload and Microsoft Graph integration, an Azure App Registration is required.

ğŸ— Step 1 â€“ Create Azure App Registration

Go to Azure Portal

Navigate to:

Azure Active Directory â†’ App registrations â†’ New registration


Configure:

Setting	Value
Name	Autopilot Upload Automation
Supported account types	Single tenant
Redirect URI	(Optional for future API integration)

Click Register

ğŸ”‘ Step 2 â€“ Create Client Secret

Go to:

Certificates & secrets


Click New client secret

Set expiration

Copy the secret value immediately

ğŸ“Œ Step 3 â€“ API Permissions (Microsoft Graph)

Go to:

API Permissions â†’ Add Permission â†’ Microsoft Graph

ğŸ”¹ Application Permissions (Recommended for automation)

Add the following:

Permission	Purpose
Device.ReadWrite.All	Manage devices
DeviceManagementManagedDevices.ReadWrite.All	Manage enrolled devices
DeviceManagementServiceConfig.ReadWrite.All	Manage Autopilot
DeviceManagementConfiguration.ReadWrite.All	Manage configuration
Group.ReadWrite.All	Assign devices to groups (optional)
User.Read.All	Read user info

After adding:

ğŸ‘‰ Click Grant admin consent

ğŸ›¡ Minimum Required Permissions (If You Want Restricted Model)

If you want a more secure model:

Permission	Required?
DeviceManagementServiceConfig.ReadWrite.All	âœ… Mandatory
Device.ReadWrite.All	âœ… Required
Group.ReadWrite.All	Optional
ğŸ§¾ Step 4 â€“ Collect Required Values

You will need:

Value	Where to Find
Tenant ID	Azure AD â†’ Overview
Client ID	App Registration â†’ Overview
Client Secret	Certificates & Secrets
ğŸ”„ Optional: Using Delegated Permissions Instead

If using interactive login during OOBE:

Use delegated permissions:

DeviceManagementServiceConfig.ReadWrite.All

User.Read

This requires technician sign-in.

ğŸ“Š Microsoft Graph Endpoints Used

For Autopilot automation, the tool may interact with:

POST /deviceManagement/windowsAutopilotDeviceIdentities
GET  /deviceManagement/windowsAutopilotDeviceIdentities


Graph API Base URL:

https://graph.microsoft.com/v1.0/

ğŸ›¡ Security Best Practices

Never hardcode Client Secret in script

Store secrets securely (Azure Key Vault recommended)

Use certificate-based authentication for enterprise

Rotate secrets regularly

Restrict app to least privilege

ğŸ¢ Enterprise Recommendation (Production Deployment)

For enterprise environments:

âœ” Use Certificate-based authentication
âœ” Restrict app to specific security group
âœ” Enable Conditional Access
âœ” Monitor Graph API usage logs

ğŸ“Œ Permission Summary
Area	Required
Azure AD App	Yes
Microsoft Graph API	Yes
Admin Consent	Required
Intune License	Required
Autopilot Enrollment	Required
